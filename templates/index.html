<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Crops Hunter - الرئيسية</title>
    <style>
        body { font-family: Arial; direction: rtl; margin: 40px; background-color: #f9f9f9; }
        .product {
            border: 1px solid #ccc;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: #fff;
        }
        .category-title {
            margin-top: 30px;
            font-size: 24px;
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }
        .whatsapp-btn, .details-btn {
            background-color: #25D366;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            text-decoration: none;
            margin-left: 5px;
        }
        .details-btn {
            background-color: #007bff;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .header a {
            margin-left: 10px;
            text-decoration: none;
            font-weight: bold;
            color: #007bff;
        }
    </style>
</head>
<body>

<div class="header">
    <h1>Crops Hunter</h1>
    <div>
        <a href="{{ url_for('index') }}">الرئيسية</a>
        <a href="{{ url_for('contact') }}">تواصل معنا</a>
        <a href="{{ url_for('about') }}">من نحن</a>
        {% if session.get('logged_in') %}
            <a href="{{ url_for('add_product') }}">إضافة منتج</a>
            <a href="{{ url_for('logout') }}">تسجيل الخروج</a>
        {% else %}
            <a href="{{ url_for('login') }}">تسجيل الدخول</a>
        {% endif %}
    </div>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div style="padding: 10px; background-color: {% if category == 'success' %}#d4edda{% elif category == 'error' %}#f8d7da{% else %}#cce5ff{% endif %}; margin-bottom: 10px; border-radius: 5px;">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

{% for category, products in products_by_category.items() %}
  <div class="category-title">{{ category }}</div>
  {% for product in products %}
    <div class="product">
        <strong>{{ product.name }}</strong><br>
        السعر: {{ product.price }} جنيه سوداني<br>
        الوحدة: {{ product.unit }}<br>
        {% if product.quantity %}
        الكمية المتوفرة: {{ product.quantity }}<br>
        {% endif %}
        <a class="details-btn" href="{{ url_for('view_product', product_id=product.id) }}">عرض التفاصيل</a>
        <a class="whatsapp-btn"
           href="https://wa.me/249916399000?text=مرحبًا، أرغب في طلب {{ product.name }} الكمية: {{ product.quantity or '---' }} طن. %0A🔹 الاسم: %0A🔹 مكان الاستلام:"
           target="_blank">اطلب عبر واتساب</a>
    </div>
  {% endfor %}
{% endfor %}

</body>
</html>
